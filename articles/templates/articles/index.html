{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block content %}
{% if not user.is_authenticated %}
<div class="intro-bg" id="box">
  <div class="intro-box" id="box">
    <video class='intro-mv' muted autoplay>
      <source src="{% static 'movies/main_intro.mp4' %}" type="video/mp4">
      <strong>Your browser does not support the video tag.</strong>
    </video>
    <div class="jb-text">
      <p></p>
    </div>
  </div>
  <script type="text/javascript" src="{% static 'JS/movie.js'%}"></script>
</div>
{% endif %}

<div class="movie-box">
  <div class="jb-box d-flex align-items-center">
    <video class="banner-mv" muted autoplay>
      <source src="{% static 'movies/main_banner.mp4' %}" type="video/mp4">
      <strong>Your browser does not support the video tag.</strong>
    </video>
  </div>
    <div class="jb-text">
      <p></p>
    </div>
  </div>
</div>
<div class="container ">
  {% if user.is_authenticated and user.team %}
  <div class="row py-4 my-5 d-flex justify-content-center bg-white" style="border-top: 1rem solid {{ user.team.color }}; border-bottom: 1rem solid {{ user.team.color }}">
  {% else %}
  <div class="row py-4 my-5 d-flex justify-content-center bg-light" style="border-top: 1rem solid grey; border-bottom: 1rem solid grey">
  {% endif %}
    <div class="d-flex flex-column align-items-center my-3">
      <h2 class="fw-bold" style="font-size:2.5rem;">íŒ€ë³„ ë¨¹ê±°ë¦¬ ë³´ëŸ¬ê°€ê¸°<h2>
      <p class="" style="color:gray; font-size:1.2rem;">êµ¬ì¥ë³„ ë§›ì§‘ ì •ë³´ë¥¼ ì°¾ì•„ë³´ì„¸ìš”ğŸ˜€</p>
    </div>
    {% for team in teams %}
    <div class="team-card text-bg-white col-5 col-sm-3 col-lg-2 m-1 p-0">
      {% if team == user.team %}
      <div class="front" style="background-color:{{ team.color }}55;  border: 1rem ridge {{ team.color }}; border-radius:5%;">
      {% else %}
      <div class="front" style="background-color:white;  border: 1rem ridge {{ team.color }}; border-radius:5%;">
      {% endif %}
          <img src="{{ team.logo.url }}" class="card-img" alt="..."> <!--ì•ë©´-->
        
      </div>
      <a class="text-decoration-none text-center text-wrap" href="{% url 'foods:home' team.pk %}">
        <div class="back" style="background-color:{{ team.color }}; border: 1rem ridge {{ team.color }}; border-radius:5%;">
          <img src="{{ team.mascot.url }}" class="card-img" alt="..."> <!--ë’·ë©´-->
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
  <div class="container">
    <section class="my-5 py-5">
      <div class="d-flex flex-column align-items-center mt-3">
        <h2 class="fw-bold" style="font-size:2.5rem;">ì¸ê¸° ë§¤ì <h2>
        <p class="" style="color:gray; font-size:1.2rem;">ê°€ì¥ ì¸ê¸°ìˆëŠ” ë§¤ì ì„ ì°¾ì•„ë³´ì„¸ìš”ğŸ’¯</p>
      </div>

        <nav>
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">ë³„ì ìˆœ</button>
            <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">íŒ”ë¡œìš°ìˆœ</button>
            <button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact" type="button" role="tab" aria-controls="nav-contact" aria-selected="false">ë¦¬ë·°ìˆ˜ìˆœ</button>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" tabindex="0">
            <!-- ì¹´ë“œ ìŠ¬ë¼ì´ë” íš¨ê³¼ -->
            <div class='slider'>
              <div class='slide-track'>
                {% for grade in store_grade %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=grade.team_id store_pk=grade.pk %}" class="text-decoration-none text-dark">
                    {% for image in grade.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{grade.name}}</h5>
                      <p class="card-text small">
                        {{grade.items}}
                      </p>
                      <p class="small m-0">{{grade.team.stadium.name}}</p>
                      {% if grade.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:grade.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}

                <!-- í•œë²ˆ ë” ë°˜ë³µí•˜ê¸° -->

                {% for grade in store_grade %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=grade.team_id store_pk=grade.pk %}" class="text-decoration-none text-dark">
                    {% for image in grade.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{grade.name}}</h5>
                      <p class="card-text small">
                        {{grade.items}}
                      </p>
                      <p class="small m-0">{{grade.team.stadium.name}}</p>
                      {% if grade.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:grade.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab" tabindex="0">
            <!-- ì¹´ë“œ ìŠ¬ë¼ì´ë” íš¨ê³¼ -->
            <div class='slider'>
              <div class='slide-track'>
                {% for follow in store_following %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=follow.team_id store_pk=follow.pk %}" class="text-decoration-none text-dark">
                    {% for image in follow.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{follow.name}}</h5>
                      <p class="card-text small">
                        {{follow.items}}
                      </p>
                      <p class="small m-0">{{follow.team.stadium.name}}</p>
                      {% if follow.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:follow.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}

                <!-- í•œë²ˆ ë” ë°˜ë³µí•˜ê¸° -->

                {% for follow in store_following %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=follow.team_id store_pk=follow.pk %}" class="text-decoration-none text-dark">
                    {% for image in follow.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{follow.name}}</h5>
                      <p class="card-text small">
                        {{follow.items}}
                      </p>
                      <p class="small m-0">{{follow.team.stadium.name}}</p>
                      {% if follow.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:follow.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab" tabindex="0">
            <!-- ì¹´ë“œ ìŠ¬ë¼ì´ë” íš¨ê³¼ -->
            <div class='slider'>
              <div class='slide-track'>
                {% for review in store_review %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=review.team_id store_pk=review.pk %}" class="text-decoration-none text-dark">
                    {% for image in review.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{review.name}}</h5>
                      <p class="card-text small">
                        {{review.items}}
                      </p>
                      <p class="small m-0">{{review.team.stadium.name}}</p>
                      {% if review.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:review.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}

                <!-- í•œë²ˆ ë” ë°˜ë³µí•˜ê¸° -->

                {% for review in store_review %}
                <div class='slide'>
                  <div class="train-card bg-white p-3">
                    <a href="{% url 'foods:store_detail' team_pk=review.team_id store_pk=review.pk %}" class="text-decoration-none text-dark">
                    {% for image in review.store_image.all %}
                      {% if forloop.counter == 1 %}
                          <img src="{{ image.image.url }}" class="card-img-top" alt="...">
                          {% endif %}
                    {% endfor %}
                    <div class="card-body py-2 border-top">
                      <h5 class="card-title text-center">{{review.name}}</h5>
                      <p class="card-text small">
                        {{review.items}}
                      </p>
                      <p class="small m-0">{{review.team.stadium.name}}</p>
                      {% if review.store_reviews.all.count == 0 %}
                        <span class='small m-0'>í‰ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</span>
                      {% else %}
                        {% for i in ""|ljust:review.avg_grade %}
                          <span>â­</span>
                        {% endfor %}
                      {% endif %}
                      {% comment %} <p class="small m-0">â­â­â­â­â­(27ëª… í‰ê°€)</p> {% endcomment %}
                    </div>
                  </a>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>

      

    </section>
    <section class="row d-flex justify-content-center mt-5">

      <div class="col-12 col-md-6 col-xl-5 mt-4">
        <div class="pt-4 px-5" style="background-color:white; border-radius:10px; overflow:hidden; height:522px;">
          <h2 class=" fw-bold">íŒ€ ìˆœìœ„</h2>
          <p class="" style="color:gray; font-size:1rem;">ìš°ë¦¬ íŒ€ ìˆœìœ„ë¥¼ í™•ì¸í•˜ì„¸ìš”ğŸ–ï¸</p>
          <table class="table table-borderless rounded-1 bg-white text-center" style="font-size:1rem;">
            <tbody>
              {% for team in teams %}
              {% if team == user.team %}
              <tr style="border:2px solid {{ team.color }};">
              {% else %}
              <tr>
              {% endif %}
                <th scope="row">{{ team.pk }}</th>
                <td>
                  <img src="{{ team.logo.url }}" style="width:1.5rem; height:1.5rem">
                  {{ team.name }}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <div class="col-12 col-md-6 col-xl-7 mt-4">
        <div class="pt-4 ps-5" style="background-color:white; border-radius:10px; overflow:hidden; height:522px;">
          {% if user.is_authenticated and user.team %}
          <h2 class="fw-bold"><span style="border-bottom : 3px double {{user.team.color}};">{{ user.team.name }}</span> ê²Œì‹œíŒ</h2>
          <p class="" style="color:gray; font-size:1rem;">ìš°ë¦¬ íŒ€ ìµœì‹  ê²Œì‹œê¸€ì„ í™•ì¸í•˜ì„¸ìš”ğŸ”¥</p>
          {% else %}
          <h2 class="fw-bold">í†µí•© ê²Œì‹œíŒì˜ ìµœì‹  ê¸€<h2>
          <p class="" style="color:gray; font-size:1rem;">ìµœì‹  ê²Œì‹œê¸€ì„ í™•ì¸í•˜ì„¸ìš”ğŸ”¥</p>
          {% endif %}
            <table class="mt-4">
              <tbody class="text-center">
                {% for article in articles %}
                {% if article.user.team == user.team %}
                <tr class="mt-4" style="font-size:1.2rem; margin:2rem 0 2rem 0; height:2.8rem;">
                  <th scope="row" style="font-size:1.2rem; font-weight:500; color:gray;">{{ article.category }}</th>
                  <td class="text-start" style="font-size:1.2rem;"><a href="{% url 'articles:detail' article.pk %}" class="text-black text-decoration-none">{{ article.title }}</a></td>
                </tr>
                {% endif %}
                {% endfor %}
              </tbody>
            </table>
            <div class="small text-end me-5"><a class="text-decoration-none text-black fs-6" href="{% url 'articles:community' %}">ì „ì²´ê¸€ ë³´ê¸°></a></div>
          </div>
        </div>
      </div>

      <div class="col-12 col-md-12 col-xl-12 col-xxl-12 px-2 mt-4">
        <div class="row pt-4 px-5 d-flex" style="background-color:white; border-radius:10px; overflow:hidden;">
          <div class="col-12 col-md-5">
            <h2 class=" fw-bold">ë‰´ìŠ¤ ê¸°ì‚¬</h2>
            <p class="" style="color:gray; font-size:1rem;">ìµœì‹  ë‰´ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”ğŸ“°</p>
          </div>
          <div style="overflow:hidden;" id="carouselExampleControls" class="col-12 col-md-7 carousel slide rotate-carousel w-25" data-bs-ride="carousel">
              <div class="carousel-inner">
                <div class="carousel-item active rotate-carousel-inner">
                  <p>ê¸€ì ìºëŸ¬ì…€ í…ŒìŠ¤íŠ¸ alphabet 11111111</p>
                </div>
                <div class="carousel-item rotate-carousel-inner">
                  <p>ê¸€ì ìºëŸ¬ì…€ í…ŒìŠ¤íŠ¸ alphabet 22222222</p>
                </div>
                <div class="carousel-item rotate-carousel-inner">
                  <p>ê¸€ì ìºëŸ¬ì…€ í…ŒìŠ¤íŠ¸ alphabet 33333333</p>
                </div>
              </div>
            </div>
        </div>
      </div>

      

      <!-- ë„¤ì´ë²„ ë‰´ìŠ¤ API -->
      {% for news in temp_news.items %}
        <a href="{{ news.link }}"><p>{{ news.title }}</p></a>
      {% endfor %}
    </section>
  </div>
</div>

{% comment %} <script>
  let observer = new IntersectionObserver((e) => {
    e.forEach((box)=>{
      box.target.opacity = 1;
    })
  })
  
  let h2 = document.querySelectorAll("h2")
  observer.observer(h2[0])
  observer.observer(h2[1])

</script> {% endcomment %}
{% endblock %}